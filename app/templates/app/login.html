<!DOCTYPE html>
<html lang="pt-br">
  <head>
    {% block head %}
      {% block meta %}
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="sortcut icon" href="/static/images/csv_export_ico.ico" type="image/x-icon" />;
        <!-- Meta, title, CSS, favicons, etc. -->
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
      {% endblock meta %}

      <title>Lumax Movelaria | {% block title %}{% endblock %}</title>

      {% block stylesheets %}
        <!-- Bootstrap -->
        <link href="/static/vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">

        <link href="/static/vendors/bootstrap/dist/css/bootstrap-datetimepicker.css" rel="stylesheet">
        <!-- Font Awesome -->
        <link href="/static/vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet">
        <!-- NProgress -->
        <link href="/static/vendors/nprogress/nprogress.css" rel="stylesheet">
        <!-- bootstrap-daterangepicker -->
        <link href="/static/vendors/bootstrap-daterangepicker/daterangepicker.css" rel="stylesheet">
        <!-- iCheck -->
        <link href="/static/vendors/iCheck/skins/flat/green.css" rel="stylesheet">
        <!-- bootstrap-progressbar -->
        <link href="/static/vendors/bootstrap-progressbar/css/bootstrap-progressbar-3.3.4.min.css" rel="stylesheet">
        <!-- JQVMap -->
        <link href="/static/vendors/jqvmap/dist/jqvmap.min.css" rel="stylesheet"/>
        <!-- Jquery  Confirm-->
        <link href="/static/vendors/jquery-confirm-master/dist/jquery-confirm.min.css" rel="stylesheet">
      {% endblock stylesheets %}
      <!-- Custom Theme Style -->
      <link href="/static/build/css/custom.css" rel="stylesheet">
      
    {% endblock head %}
  </head>
    <style>
     select {

      color: gray;
      }
      option[value=""][disabled] {
        display: none;
      }
      option {
        color: black;
      }
    </style>
  <script>
    function formCadastroEmpresa(){
      $("#form_login").hide();
      $("#register").show();
    }
    function formLogin(){
      $("#form_login").show();
      $("#register").hide();
      $('#alert_error').remove();
      limparInputs();
    }
    function limparInputs(){
      $("#id_login").val(''),
      $("#id_password").val(''),
      $("#id_CNPJ").val(''),
      $("#id_username").val(''),
      $("#id_nome").val(''),
      $("#id_nome_fantasia").val(''),
      $("#id_mensalidade").val(''),
      $("#id_vencimento").val(''),
      $("#id_user_nome").val(''),
      $("#id_CPF").val(''),
      $("#id_user_email").val(''),
      $("#id_user_telefone").val(''),
      $("#id_senha").val(''),
      $("#id_confirm_senha").val(''),
      $("#id_tipo_endereco").val(''),
      $("#id_CEP").val(''),
      $("#id_tipo_logradouro").val(''),
      $("#id_logradouro").val(''),
      $("#id_numero").val(''),
      $("#id_complemento").val(''),
      $("#id_bairro").val(''),
      $("#id_confirm_senha").val(''),
      $("#id_referencia").val(''),
      $("#id_cidade").val(''),
      $("#id_estado").val('')
    }

    function buscarUsername(id, flag){
       $.ajax({
              data: {
                username :  $("#id_username").val(),
                email    :  $("#id_user_email").val(),
                tipo    :  flag
                },
              type: 'GET',
              url:'/cadastros/usuarios/buscar/'
            }).done(function(data){
                if(data.flag == 0){
                  text = data.mensagem
                  addAlert(id, text);
                }else{
                   $('#alert_error').remove();
                }
            });

    }

    function buscarCNPJ(id){
       $.ajax({
              data: {
                cnpj :  $("#id_CNPJ").val(),
                },
              type: 'GET',
              url:'/cadastros/empresas/buscar/CNPJ'
            }).done(function(data){
                if(data.flag == 0){
                  text = data.mensagem
                  addAlert(id, text);
                }else{
                   $('#alert_error').remove();
                }
            });

    }

    function addAlert(id, text){
      $(id).parent().addClass("bad");
      txt = '<div id="alert_error" style="color: #CE5454; margin-top: -20px; text-align: left;"><p >'+text+'</p></div>'
      $(id).parent().append(txt);
    }

  </script>
  <body class="login">
    <div>
      <a class="hiddenanchor" id="signup"></a>
      <a class="hiddenanchor" id="signin"></a>

      <div class="login_wrapper">
        <div class="animate form login_form" id="form_login">
          <section class="login_content">
            <form method="post" action="/auth/">{% csrf_token %}
              <img src=''></br></br></br>
              <div>
                <input type="text" class="form-control" id="id_login" name ="username" placeholder="usuário" required />
              </div>
              <div>
                <input type="password" class="form-control" id="id_password" name="password" placeholder="senha" required />
              </div>
              <div>
                 </br><button type="submit" class="btn btn-round btn-success">entrar</button></br></br></br>
              </div>
              <div class="separator">
              <div class="change_link navbar-right">Não possue uma conta? <a onclick="formCadastroEmpresa()"><small>Cadastre sua empresa</small></a></div>
              </br>
               </br></br> <p class="change_link">SUPORTE</p>

                <div class="clearfix"></div>
                <br />

                <div>
                  <p>(12) 3025-2640</br>contato@cloudssistemas.com.br</p>
                </div>
              </div>

            </form>
          </section>
        </div>

        <div id="register" class="animate form login_form" style="display: none;">
          <section class="login_content">
            <img src=''></br></br>
            <form novalidate id="form_criar_conta">
              <h1>Criar Conta</h1>
              <div class="clearfix"></div>
              <div class="separator">Usuario</div></br>

              <div class="col-md-12 col-sm-12 col-xs-12 item form-group" >
                <input type="text" class="form-control" placeholder="Username" id="id_username" required="required" onchange="buscarUsername('#id_username','username')" />
              </div>
              
              <div class="col-md-12 col-sm-12 col-xs-12 item form-group">
                <input type="text" class="form-control" placeholder="Nome" id="id_user_nome" required="required" />
              </div>

              <div class="col-md-12 col-sm-12 col-xs-12 item form-group">
                <input type="text" class="form-control cpf" placeholder="CPF" id="id_CPF" required="required" />
              </div>

              <div class="col-md-12 col-sm-12 col-xs-12 item form-group">
                <input type="text" class="form-control" placeholder="Email" id="id_user_email" required="required" onchange="buscarUsername('#id_user_email', 'email')" />
              </div>

              <div class="col-md-12 col-sm-12 col-xs-12 item form-group">
                <input type="text" class="form-control tel" placeholder="Telefone" id="id_user_telefone" required="required" />
              </div>

              <div class="col-md-12 col-sm-12 col-xs-12 item form-group">
                <input type="password" class="form-control" placeholder="Senha" id="id_senha" name="id_senha" required="required" />
              </div>

              <div class="col-md-12 col-sm-12 col-xs-12 item form-group">
                <input type="password" class="form-control" data-validate-linked="id_senha" placeholder="Confirmar senha" id="id_confirm_senha" required="required" />
              </div>

               <div class="clearfix"></div>
              <div class="separator">Dados da Empresa</div></br>
              <div class="col-md-12 col-sm-12 col-xs-12 item form-group">
                <input type="text" class="form-control cnpj" placeholder="CNPJ" id="id_CNPJ" required="required" onchange="buscarCNPJ('#id_CNPJ')"/>
              </div>
              <div class="col-md-12 col-sm-12 col-xs-12 item form-group">
                <input type="text" class="form-control" placeholder="Razão social" id="id_nome" required="required" />
              </div>
              <div class="col-md-12 col-sm-12 col-xs-12 item form-group">
                <input type="text" class="form-control" placeholder="Nome fantasia" id="id_nome_fantasia" required="required" />
              </div>
              <div class="col-md-6 col-sm-6 col-xs-12 item form-group">
                <select title="Plano" class="selectpicker form-control" data-live-search="true" style="width: 100%"  id ="id_mensalidade" required="required">
                  <option value="" disabled selected hidden>Plano</option>
                  <option value= "50">Beta</option>
                  <option value= "100">Alfa</option>
                </select>
              </div>
              <div class="col-md-6 col-sm-6 col-xs-12 item form-group">
                <select id="id_vencimento" title="Dia Vencimento" class="selectpicker form-control" data-live-search="true"  style="width: 100%" required="required">
                  <option value="" disabled selected >Vencimento</option>
                  <option value="1">01</option>
                  <option value="2">02</option>
                  <option value="3">03</option>
                  <option value="4">04</option>
                  <option value="5">05</option>
                  <option value="6">06</option>
                  <option value="7">07</option>
                  <option value="8">08</option>
                  <option value="9">09</option>
                  <option value="10">10</option>
                  <option value="11">11</option>
                  <option value="12">12</option>
                  <option value="13">13</option>
                  <option value="14">14</option>
                  <option value="15">15</option>
                  <option value="16">16</option>
                  <option value="17">17</option>
                  <option value="18">18</option>
                  <option value="19">19</option>
                  <option value="20">20</option>
                  <option value="21">21</option>
                  <option value="22">22</option>
                  <option value="23">23</option>
                  <option value="24">24</option>
                  <option value="25">25</option>
                  <option value="26">26</option>
                  <option value="27">27</option>
                  <option value="28">28</option>
                  <option value="29">29</option>
                  <option value="30">30</option>
                  <option value="31">31</option>
                </select>
              </div>    

              <div class="clearfix"></div>
              <div class="separator">Endereço</div></br>

              <div class="col-md-6 col-sm-6 col-xs-12 item form-group">
                <select select id="id_tipo_endereco" title="Tipo" class="selectpicker form-control" data-live-search="true" style="width: 100%" required="required">
                  <option value="" disabled selected >Tipo</option>
                  <option value="Sede">Sede</option>
                  <option value="Entrega">Entrega</option>
                  <option value="Cobrança">Cobrança</option>
                </select>
              </div>

              <div class="col-md-6 col-sm-6 col-xs-12 item form-group">
                <input type="text" class="form-control cep" placeholder="CEP" id="id_CEP" required="required" />
              </div>

              <div class="col-md-12 col-sm-12 col-xs-12 item form-group" style="margin-bottom: 20px">
                <select id="id_tipo_logradouro" title="tipo logradouro" class="selectpicker form-control" data-live-search="true" style="width: 100%" required="required">
                  <option value="" disabled selected >Tipo Logradouro</option>
                  <option value="Rua">Rua</option>
                  <option value="Avenida">Avenida</option>
                  <option value="Praça">Praça</option>
                  <option value="Largo">Largo</option>
                  <option value="Travessa">Travessa</option>
                  <option value="Rodovia">Rodovia</option>
                  <option value="Estrada">Estrada</option>
                  <option value="Estrada">Via</option>
                  <option value="Alameda">Alameda</option>
                  <option value="Quadra">Quadra</option>
                </select>
              </div>

              <div class="col-md-12 col-sm-12 col-xs-12 item form-group">
                <input type="text" class="form-control" placeholder="Logradouro" id="id_logradouro" required="required" />
              </div>

              <div class="col-md-12 col-sm-12 col-xs-12 item form-group" style="margin-bottom: 20px">
                <input type="number" class="form-control" placeholder="Numero" id="id_numero" required="required" />
              </div>

              <div class="col-md-12 col-sm-12 col-xs-12 item form-group" >
                <input type="text" class="form-control" placeholder="Complemento" id="id_complemento" />
              </div>

              <div class="col-md-12 col-sm-12 col-xs-12 item form-group">
                <input type="text" class="form-control" placeholder="Bairro" id="id_bairro" required="required" />
              </div>

              <div class="col-md-12 col-sm-12 col-xs-12 item form-group">
                <input type="text" class="form-control" placeholder="Referência" id="id_referencia" />
              </div>

              <div class="col-md-6 col-sm-6 col-xs-12 item form-group">
                <input type="text" class="form-control" placeholder="Cidade" id="id_cidade" required="required" />
              </div>

              <div class="col-md-6 col-sm-6 col-xs-12 item form-group">
                <select id="id_estado" title="Estado" class="selectpicker form-control" data-live-search="true" style="width: 100%" required="required">
                  <option value="" disabled selected >Estado</option>
                  <option>AC</option>
                  <option>AL</option>
                  <option>AP</option>
                  <option>AM</option>
                  <option>BA</option>
                  <option>CE</option>
                  <option>DF</option>
                  <option>ES</option>
                  <option>GO</option>
                  <option>MA</option>
                  <option>MT</option>
                  <option>MS</option>
                  <option>MG</option>
                  <option>PA</option>
                  <option>PB</option>
                  <option>PR</option>
                  <option>PE</option>
                  <option>PI</option>
                  <option>RJ</option>
                  <option>RN</option>
                  <option>RS</option>
                  <option>RO</option>
                  <option>RR</option>
                  <option>SC</option>
                  <option value="SP" selected>SP</option>
                  <option>SE</option>
                  <option>TO</option>
                </select>
              </div>
              <div class="form-group">
                <div class="col-md-8 col-md-offset-2">
                  <button class="btn btn-primary" type="button" value="cancelar" onclick="formLogin()">Cancelar</button>
                  <button id="send" type="submit" value="salvar" class="btn btn-success">Salvar</button>
                </div>
              </div>

              <div class="clearfix"></div>

              <div class="separator">
                <p class="change_link">Já está cadastrado?
                  <a class="to_register" onclick="formLogin()"> Log in </a>
                </p>

                <div class="clearfix"></div>
                <div>

                  <p>2017 All Rights Reserved. Clouds Sistemas LTDA ME</p>
                </div>
              </div>
            </form>
          </section>
        </div>
      </div>
    </div>
 {% block javascripts %}
        <!-- jQuery -->
        <script src="/static/vendors/jquery/dist/jquery.min.js"></script>
        <script src="/static/js/jquery.mask.js"></script>

        <!-- Bootstrap -->
        <script src="/static/vendors/bootstrap/dist/js/bootstrap.min.js"></script>
        
        <!-- FastClick -->
        <script src="/static/vendors/fastclick/lib/fastclick.js"></script>
        <!-- NProgress -->
        <script src="/static/vendors/nprogress/nprogress.js"></script>
        <!-- bootstrap-progressbar -->
        <script src="/static/vendors/bootstrap-progressbar/bootstrap-progressbar.min.js"></script>
        <!-- iCheck -->
        <script src="/static/vendors/iCheck/icheck.min.js"></script>
        <!-- bootstrap-daterangepicker -->
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.js"></script> 
        <!--<script src="/static/vendors/moment/min/moment.min.js"></script>-->
        <script  src="/static/vendors/bootstrap/dist/js/bootstrap-datetimepicker.js"></script>
        <script src="/static/vendors/bootstrap-daterangepicker/daterangepicker.js"></script>
        <!-- bootstrap-wysiwyg -->
        <script src="/static/vendors/bootstrap-wysiwyg/js/bootstrap-wysiwyg.min.js"></script>
        <script src="/static/vendors/jquery.hotkeys/jquery.hotkeys.js"></script>
        <script src="/static/vendors/google-code-prettify/src/prettify.js"></script>
        <!-- jQuery Tags Input -->
        <script src="/static/vendors/jquery.tagsinput/src/jquery.tagsinput.js"></script>
        <!-- Switchery -->
        <script src="/static/vendors/switchery/dist/switchery.min.js"></script>
        <!-- Select2 -->
        <script src="/static/vendors/select2/dist/js/select2.full.min.js"></script>
        <!-- Parsley -->
        <script src="/static/vendors/parsleyjs/dist/parsley.min.js"></script>
        <!-- Autosize -->
        <script src="/static/vendors/autosize/dist/autosize.min.js"></script>
        <!-- Dialogos -->
        <script src="/static/vendors/jquery-confirm-master/dist/jquery-confirm.min.js"></script>
        <!-- Screen Full -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/screenfull.js/3.3.3/screenfull.min.js"></script>

        <!-- jQuery autocomplete -->
        <script src="/static/vendors/devbridge-autocomplete/dist/jquery.autocomplete.min.js"></script>
        <!-- starrr -->
        <script src="/static/vendors/starrr/dist/starrr.js"></script>
        <!-- Base -->
        <script src="/static/js/base.js"></script>

      {% endblock %}
      <!-- Custom Theme Scripts -->
      <script src="/static/build/js/custom.js"></script>

    <script>
      // initialize the validator function
      validator.message.date = 'not a real date';

      // validate a field on "blur" event, a 'select' on 'change' event & a '.reuired' classed multifield on 'keyup':
      $('form')
        .on('blur', 'input[required], input.optional, select.required', validator.checkField)
        .on('change', 'select.required', validator.checkField)
        .on('keypress', 'input[required][pattern]', validator.keypress);

      $('.multi.required').on('keyup blur', 'input', function() {
        validator.checkField.apply($(this).siblings().last()[0]);
      });

    
      $('#form_criar_conta').submit(function(e) {

        e.preventDefault();
        var submit = true;

        // evaluate the form using generic validaing
        if (!validator.checkAll($(this))) {
          submit = false;
        }

        if (submit){
             $.ajax({
                data: {
                  csrfmiddlewaretoken: '{{token}}',
                  emp : {
                    CNPJ : $("#id_CNPJ").val(),
                    username : $("#id_username").val(),
                    nome : $("#id_nome").val(),
                    nome_fantasia : $("#id_nome_fantasia").val(),
                    mensalidade : $("#id_mensalidade").val(),
                    vencimento : $("#id_vencimento").val(),
                    user_nome : $("#id_user_nome").val(),
                    CPF : $("#id_CPF").val(),
                    user_email : $("#id_user_email").val(),
                    user_telefone : $("#id_user_telefone").val(),
                    senha : $("#id_senha").val(),
                    confirm_senha : $("#id_confirm_senha").val(),
                    tipo_endereco : $("#id_tipo_endereco").val(),
                    CEP : $("#id_CEP").val(),
                    tipo_logradouro : $("#id_tipo_logradouro").val(),
                    logradouro : $("#id_logradouro").val(),
                    numero : $("#id_numero").val(),
                    complemento : $("#id_complemento").val(),
                    bairro : $("#id_bairro").val(),
                    referencia : $("#id_referencia").val(),
                    cidade : $("#id_cidade").val(),
                    estado : $("#id_estado").val()
                  }
                },
                type: 'POST',
                url:'/cadastros/empresas/'
              }).done(function(data){
                if(data.flag == 1){
                  limparInputs();
                  formLogin();
                  new PNotify({
                                    title: 'Sucesso',
                                    text: 'Usuario cadastrado com Sucesso.',
                                    type: 'success',
                                    hide: false,
                                    styling: 'bootstrap3'
                                });
                  
                }
                else{
                  new PNotify({
                                    title: 'Oh No!',
                                    text: data.mensagem,
                                    type: 'error',
                                    styling: 'bootstrap3'
                                });
                }
              });
            }

        return false;
      });
      $(document).ready(function(){
        $('.selectpicker').selectpicker("refresh");
        $('.tel').mask('(00) 00000-0009');
        $('.cnpj').mask('00.000.000/0000-00', {reverse: true});
        $('.cpf').mask('000.000.000-00', {reverse: true});
        $('.cep').mask('00000-000');       
      });
      
    </script>
  </body>
</html>
