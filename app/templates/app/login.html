<!DOCTYPE html>
<html lang="pt-br">
  <head>
    {% block head %}
      {% block meta %}
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="sortcut icon" href="/static/images/csv_export_ico.ico" type="image/x-icon" />;
        <!-- Meta, title, CSS, favicons, etc. -->
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
      {% endblock meta %}

      <title>Lumax Movelaria | {% block title %}{% endblock %}</title>

      {% block stylesheets %}
        <!-- Bootstrap -->
        <link href="/static/vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">

        <link href="/static/vendors/bootstrap/dist/css/bootstrap-datetimepicker.css" rel="stylesheet">
        <!-- Font Awesome -->
        <link href="/static/vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet">
        <!-- NProgress -->
        <link href="/static/vendors/nprogress/nprogress.css" rel="stylesheet">
        <!-- bootstrap-daterangepicker -->
        <link href="/static/vendors/bootstrap-daterangepicker/daterangepicker.css" rel="stylesheet">
        <!-- iCheck -->
        <link href="/static/vendors/iCheck/skins/flat/green.css" rel="stylesheet">
        <!-- bootstrap-progressbar -->
        <link href="/static/vendors/bootstrap-progressbar/css/bootstrap-progressbar-3.3.4.min.css" rel="stylesheet">
        <!-- JQVMap -->
        <link href="/static/vendors/jqvmap/dist/jqvmap.min.css" rel="stylesheet"/>
        <!-- Jquery  Confirm-->
        <link href="/static/vendors/jquery-confirm-master/dist/jquery-confirm.min.css" rel="stylesheet">
      {% endblock stylesheets %}
      <!-- Custom Theme Style -->
      <link href="/static/build/css/custom.css" rel="stylesheet">

    {% endblock head %}
  </head>
    <style>
     select {

      color: gray;
      }
      option[value=""][disabled] {
        display: none;
      }
      option {
        color: black;
      }
    </style>
  <script>
    function formCadastroEmpresa(){
      $("#form_login").hide();
      $("#register").show();
    }
    function formLogin(){
      $("#form_login").show();
      $("#register").hide();
      $('#alert_error').remove();
      limparInputs();
    }
    function limparInputs(){
      $("#id_login").val(''),
      $("#id_password").val(''),
      $("#id_CNPJ").val(''),
      $("#id_username").val(''),
      $("#id_nome").val(''),
      $("#id_nome_fantasia").val(''),
      $("#id_mensalidade").val(''),
      $("#id_vencimento").val(''),
      $("#id_user_nome").val(''),
      $("#id_CPF").val(''),
      $("#id_user_email").val(''),
      $("#id_user_telefone").val(''),
      $("#id_senha").val(''),
      $("#id_confirm_senha").val(''),
      $("#id_tipo_endereco").val(''),
      $("#id_CEP").val(''),
      $("#id_tipo_logradouro").val(''),
      $("#id_logradouro").val(''),
      $("#id_numero").val(''),
      $("#id_complemento").val(''),
      $("#id_bairro").val(''),
      $("#id_confirm_senha").val(''),
      $("#id_referencia").val(''),
      $("#id_cidade").val(''),
      $("#id_estado").val('')
    }

    function buscarUsername(id, flag){
       $.ajax({
              data: {
                username :  $("#id_username").val(),
                email    :  $("#id_user_email").val(),
                tipo    :  flag
                },
              type: 'GET',
              url:'/cadastros/usuarios/buscar/'
            }).done(function(data){
                if(data.flag == 0){
                  text = data.mensagem
                  addAlert(id, text);
                }else{
                   $('#alert_error').remove();
                }
            });

    }

    function buscarCNPJ(id){
       $.ajax({
              data: {
                cnpj :  $("#id_CNPJ").val(),
                },
              type: 'GET',
              url:'/cadastros/empresas/buscar/CNPJ'
            }).done(function(data){
                if(data.flag == 0){
                  text = data.mensagem
                  addAlert(id, text);
                }else{
                   $('#alert_error').remove();
                }
            });

    }

    function addAlert(id, text){
      $(id).parent().addClass("bad");
      txt = '<div id="alert_error" style="color: #CE5454; margin-top: -20px; text-align: left;"><p >'+text+'</p></div>'
      $(id).parent().append(txt);
    }

  </script>
  <body class="login">
    <div>
      <a class="hiddenanchor" id="signup"></a>
      <a class="hiddenanchor" id="signin"></a>

      <div class="login_wrapper">
        <div class="animate form login_form" id="form_login">
          <section class="login_content">
            <form method="post" action="/auth/">{% csrf_token %}
              <img style="display: block; margin-left: auto; margin-right: auto; width: 90%;" src='/static/images/Lumax Movelaria IDENTIDADE VISUAL3.png'></br></br>
              <div>
                <input type="text" class="form-control" id="id_login" name ="username" placeholder="usuÃ¡rio" required />
              </div>
              <div>
                <input type="password" class="form-control" id="id_password" name="password" placeholder="senha" required />
              </div>
              <div>
                 </br><button type="submit" class="btn btn-round btn-success">entrar</button></br></br></br>
              </div>
              <div class="separator">
              </br>
               </br></br> <p class="change_link">SUPORTE</p>

                <div class="clearfix"></div>
                <br />

                <div>
                  <p>(12) 3022-9868 </br>contato@lumaxmovelaria.com.br</p>
                </div>
              </div>

            </form>
            <div class="clearfix"></div>
            <div>
              <p>2019 All Rights Reserved. LUMAX MOVELARIA</p>
            </div>
          </section>
        </div>
    </div>
 {% block javascripts %}
        <!-- jQuery -->
        <script src="/static/vendors/jquery/dist/jquery.min.js"></script>
        <script src="/static/js/jquery.mask.js"></script>

        <!-- Bootstrap -->
        <script src="/static/vendors/bootstrap/dist/js/bootstrap.min.js"></script>

        <!-- FastClick -->
        <script src="/static/vendors/fastclick/lib/fastclick.js"></script>
        <!-- NProgress -->
        <script src="/static/vendors/nprogress/nprogress.js"></script>
        <!-- bootstrap-progressbar -->
        <script src="/static/vendors/bootstrap-progressbar/bootstrap-progressbar.min.js"></script>
        <!-- iCheck -->
        <script src="/static/vendors/iCheck/icheck.min.js"></script>
        <!-- bootstrap-daterangepicker -->
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.js"></script>
        <!--<script src="/static/vendors/moment/min/moment.min.js"></script>-->
        <script  src="/static/vendors/bootstrap/dist/js/bootstrap-datetimepicker.js"></script>
        <script src="/static/vendors/bootstrap-daterangepicker/daterangepicker.js"></script>
        <!-- bootstrap-wysiwyg -->
        <script src="/static/vendors/bootstrap-wysiwyg/js/bootstrap-wysiwyg.min.js"></script>
        <script src="/static/vendors/jquery.hotkeys/jquery.hotkeys.js"></script>
        <script src="/static/vendors/google-code-prettify/src/prettify.js"></script>
        <!-- jQuery Tags Input -->
        <script src="/static/vendors/jquery.tagsinput/src/jquery.tagsinput.js"></script>
        <!-- Switchery -->
        <script src="/static/vendors/switchery/dist/switchery.min.js"></script>
        <!-- Select2 -->
        <script src="/static/vendors/select2/dist/js/select2.full.min.js"></script>
        <!-- Parsley -->
        <script src="/static/vendors/parsleyjs/dist/parsley.min.js"></script>
        <!-- Autosize -->
        <script src="/static/vendors/autosize/dist/autosize.min.js"></script>
        <!-- Dialogos -->
        <script src="/static/vendors/jquery-confirm-master/dist/jquery-confirm.min.js"></script>
        <!-- Screen Full -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/screenfull.js/3.3.3/screenfull.min.js"></script>

        <!-- jQuery autocomplete -->
        <script src="/static/vendors/devbridge-autocomplete/dist/jquery.autocomplete.min.js"></script>
        <!-- starrr -->
        <script src="/static/vendors/starrr/dist/starrr.js"></script>
        <!-- Base -->
        <script src="/static/js/base.js"></script>

      {% endblock %}
      <!-- Custom Theme Scripts -->
      <script src="/static/build/js/custom.js"></script>

    <script>
      // initialize the validator function
      validator.message.date = 'not a real date';

      // validate a field on "blur" event, a 'select' on 'change' event & a '.reuired' classed multifield on 'keyup':
      $('form')
        .on('blur', 'input[required], input.optional, select.required', validator.checkField)
        .on('change', 'select.required', validator.checkField)
        .on('keypress', 'input[required][pattern]', validator.keypress);

      $('.multi.required').on('keyup blur', 'input', function() {
        validator.checkField.apply($(this).siblings().last()[0]);
      });


      $('#form_criar_conta').submit(function(e) {

        e.preventDefault();
        var submit = true;

        // evaluate the form using generic validaing
        if (!validator.checkAll($(this))) {
          submit = false;
        }

        if (submit){
             $.ajax({
                data: {
                  csrfmiddlewaretoken: '{{token}}',
                  emp : {
                    CNPJ : $("#id_CNPJ").val(),
                    username : $("#id_username").val(),
                    nome : $("#id_nome").val(),
                    nome_fantasia : $("#id_nome_fantasia").val(),
                    mensalidade : $("#id_mensalidade").val(),
                    vencimento : $("#id_vencimento").val(),
                    user_nome : $("#id_user_nome").val(),
                    CPF : $("#id_CPF").val(),
                    user_email : $("#id_user_email").val(),
                    user_telefone : $("#id_user_telefone").val(),
                    senha : $("#id_senha").val(),
                    confirm_senha : $("#id_confirm_senha").val(),
                    tipo_endereco : $("#id_tipo_endereco").val(),
                    CEP : $("#id_CEP").val(),
                    tipo_logradouro : $("#id_tipo_logradouro").val(),
                    logradouro : $("#id_logradouro").val(),
                    numero : $("#id_numero").val(),
                    complemento : $("#id_complemento").val(),
                    bairro : $("#id_bairro").val(),
                    referencia : $("#id_referencia").val(),
                    cidade : $("#id_cidade").val(),
                    estado : $("#id_estado").val()
                  }
                },
                type: 'POST',
                url:'/cadastros/empresas/'
              }).done(function(data){
                if(data.flag == 1){
                  limparInputs();
                  formLogin();
                  new PNotify({
                                    title: 'Sucesso',
                                    text: 'Usuario cadastrado com Sucesso.',
                                    type: 'success',
                                    hide: false,
                                    styling: 'bootstrap3'
                                });

                }
                else{
                  new PNotify({
                                    title: 'Oh No!',
                                    text: data.mensagem,
                                    type: 'error',
                                    styling: 'bootstrap3'
                                });
                }
              });
            }

        return false;
      });
      $(document).ready(function(){
        $('.selectpicker').selectpicker("refresh");
        $('.tel').mask('(00) 00000-0009');
        $('.cnpj').mask('00.000.000/0000-00', {reverse: true});
        $('.cpf').mask('000.000.000-00', {reverse: true});
        $('.cep').mask('00000-000');
      });

    </script>
  </body>
</html>
